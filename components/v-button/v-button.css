:host {
  display: block;
  width: max-content;
  --v-button-transition-duration: 0.2s;
  --v-button-ripple-mix-default: 7%;
  --v-button-ripple-mix-strong: 15%;
  --v-button-mix-hover: 88%;
  --v-button-mix-active: 82%;
  --v-button-mix-link-hover: 80%;
  --v-button-mix-hover-contrast: 12%;
  --v-button-mix-active-contrast: 18%;
  --v-button-mix-link-hover-contrast: 20%;
  --v-button-mix-hover-strong: 90%;
  --v-button-mix-hover-strong-contrast: 10%;
  --v-button-shadow-role: 0 2px 4px rgba(15, 23, 42, 0.16);
  --v-button-shadow-role-hover: 0 6px 12px rgba(15, 23, 42, 0.22);
}

button {
  display: flex;
  align-items: center;
  width: 100%;
  box-sizing: border-box;
  border: 1px solid transparent;
  outline: none;
  cursor: pointer;
  font-family: inherit;
  font-size: 1rem;
  font-weight: 500;
  overflow: hidden;
  position: relative;

  padding: var(--v-button-padding-y, var(--unit-2)) var(--v-button-padding-x, var(--unit-4));
  border-radius: var(--v-button-border-radius, var(--unit-1));

  background: color-mix(in oklab, var(--v-color-surface) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
  color: var(--v-color-text);

  transition:
    background var(--v-button-transition-duration) ease,
    box-shadow var(--v-button-transition-duration) ease,
    border-color var(--v-button-transition-duration) ease,
    color var(--v-button-transition-duration) ease;

  &:disabled {
    opacity: 0.4;
    cursor: not-allowed;
    pointer-events: none;
  }
}

.v-button-ripple {
  position: absolute;
  border-radius: 50%;
  transform: scale(0);
  pointer-events: none;
  background: color-mix(in oklab, currentColor var(--v-button-ripple-mix-default), transparent);
  animation: v-button-ripple 0.6s ease-out;
}

:host(.v-primary) .v-button-ripple,
:host(.v-danger) .v-button-ripple,
:host(.v-accent) .v-button-ripple {
  background: color-mix(in oklab, currentColor var(--v-button-ripple-mix-strong), transparent);
}

@keyframes v-button-ripple {
  to {
    transform: scale(1);
    opacity: 0;
  }
}

button > :not(.prefix):not(.postfix) {
  flex: 1;
}

.btn-text {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  white-space: nowrap;
  margin-inline: var(--unit-2);
}

:host([text-align='left']) .btn-text {
  justify-content: flex-start;
}

:host([text-align='right']) .btn-text {
  justify-content: flex-end;
}

.prefix,
.postfix {
  display: inline-flex;
  align-items: center;
  justify-content: center;
}

:host(:not(.v-flat):not(.v-raised):not(.v-link):not(.v-hover)) {
  &.v-primary {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-primary) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-primary) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-danger {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-danger) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-danger) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-danger) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-accent {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-accent) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-accent) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-accent) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }
}

:host(.v-flat) {
  button {
    background: var(--v-color-surface);
    border-color: var(--v-color-border-subtle);
    box-shadow: none;
  }

  @media (hover: hover) {
    button:hover {
      border-color: color-mix(in oklab, var(--v-color-text) 35%, transparent);
    }
  }

  &.v-primary {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-primary) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-primary) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        border-color: transparent;
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-primary) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-danger {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-danger) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-danger) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        border-color: transparent;
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-danger) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-danger) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-accent {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-accent) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-accent) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        border-color: transparent;
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-accent) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-accent) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }
}

:host(.v-raised) {
  button {
    background: var(--v-color-surface);
    box-shadow: var(--v-shadow-outer-1);

    &:active {
      box-shadow: var(--v-shadow-outer-1);
    }
  }

  @media (hover: hover) {
    button:hover {
      box-shadow: var(--v-shadow-outer-2);
    }
  }

  &:not(.v-primary):not(.v-danger):not(.v-accent) {
    button {
      border-color: var(--v-color-border-subtle);
    }
  }

  @media (hover: hover) {
    &:not(.v-primary):not(.v-danger):not(.v-accent) {
      button:hover {
        border-color: color-mix(in oklab, var(--v-color-text) 35%, transparent);
      }
    }

    :host-context(.dark) &:not(.v-primary):not(.v-danger):not(.v-accent) {
      button:hover {
        border-color: color-mix(in oklab, var(--v-color-text) 35%, transparent);
      }
    }
  }

  :host-context(.dark) &:not(.v-primary):not(.v-danger):not(.v-accent) {
    button {
      border-color: var(--v-color-border-subtle);
    }
  }

  &.v-primary {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-primary) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
      box-shadow: var(--v-button-shadow-role);
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-primary) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        box-shadow: var(--v-button-shadow-role-hover);
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-primary) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
      box-shadow: var(--v-button-shadow-role);
    }
  }

  &.v-danger {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-danger) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
      box-shadow: var(--v-button-shadow-role);
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-danger) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        box-shadow: var(--v-button-shadow-role-hover);
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-danger) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-danger) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
      box-shadow: var(--v-button-shadow-role);
    }
  }

  &.v-accent {
    button {
      color: var(--v-color-text-on-accent, white);
      background: color-mix(in oklab, var(--v-color-accent) calc(var(--v-button-bg-opacity, 1) * 100%), transparent);
      border-color: transparent;
      box-shadow: var(--v-button-shadow-role);
    }

    @media (hover: hover) {
      button:hover {
        background: color-mix(
          in oklab,
          var(--v-color-accent) var(--v-button-mix-hover),
          black var(--v-button-mix-hover-contrast)
        );
        box-shadow: var(--v-button-shadow-role-hover);
      }

      :host-context(.dark) & {
        button:hover {
          background: color-mix(
            in oklab,
            var(--v-color-accent) var(--v-button-mix-hover),
            white var(--v-button-mix-hover-contrast)
          );
        }
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-accent) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
      box-shadow: var(--v-button-shadow-role);
    }
  }
}

:host(.v-link) {
  button {
    background: transparent;
    border-color: transparent;
    box-shadow: none;
    color: var(--v-color-text);

    &:active {
      color: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  @media (hover: hover) {
    button:hover {
      color: var(--v-color-primary);
      text-decoration: underline;
    }
  }

  @media (hover: hover) {
    &.v-link-static {
      button:hover {
        color: var(--v-color-text);
      }
    }
  }

  &.v-primary {
    button {
      background: transparent;
      box-shadow: none;
      color: var(--v-color-primary);
    }

    @media (hover: hover) {
      button:hover {
        color: color-mix(
          in oklab,
          var(--v-color-primary) var(--v-button-mix-link-hover),
          black var(--v-button-mix-link-hover-contrast)
        );
      }

      :host-context(.dark) & {
        button:hover {
          color: color-mix(
            in oklab,
            var(--v-color-primary) var(--v-button-mix-link-hover),
            white var(--v-button-mix-link-hover-contrast)
          );
        }
      }
    }

    button:active {
      color: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-danger {
    button {
      background: transparent;
      box-shadow: none;
      color: var(--v-color-danger);
    }

    @media (hover: hover) {
      button:hover {
        color: color-mix(
          in oklab,
          var(--v-color-danger) var(--v-button-mix-link-hover),
          black var(--v-button-mix-link-hover-contrast)
        );
      }

      :host-context(.dark) & {
        button:hover {
          color: color-mix(
            in oklab,
            var(--v-color-danger) var(--v-button-mix-link-hover),
            white var(--v-button-mix-link-hover-contrast)
          );
        }
      }
    }

    button:active {
      color: color-mix(
        in oklab,
        var(--v-color-danger) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }

  &.v-accent {
    button {
      background: transparent;
      box-shadow: none;
      color: var(--v-color-accent);
    }

    @media (hover: hover) {
      button:hover {
        color: color-mix(
          in oklab,
          var(--v-color-accent) var(--v-button-mix-link-hover),
          black var(--v-button-mix-link-hover-contrast)
        );
      }

      :host-context(.dark) & {
        button:hover {
          color: color-mix(
            in oklab,
            var(--v-color-accent) var(--v-button-mix-link-hover),
            white var(--v-button-mix-link-hover-contrast)
          );
        }
      }
    }

    button:active {
      color: color-mix(
        in oklab,
        var(--v-color-accent) var(--v-button-mix-active),
        black var(--v-button-mix-active-contrast)
      );
    }
  }
}

:host(.v-hover):not(.v-link) {
  &.v-primary {
    button {
      color: var(--v-color-text);
      background: var(--v-color-surface);
      border-color: var(--v-color-border-subtle);
    }

    @media (hover: hover) {
      button:hover {
        color: var(--v-color-text-on-accent, white);
        background: var(--v-color-primary);
        border-color: var(--v-color-primary);
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-primary) var(--v-button-mix-hover-strong),
        black var(--v-button-mix-hover-strong-contrast)
      );
    }
  }

  &.v-danger {
    button {
      color: var(--v-color-text);
      background: var(--v-color-surface);
      border-color: var(--v-color-border-subtle);
    }

    @media (hover: hover) {
      button:hover {
        color: var(--v-color-text-on-accent, white);
        background: var(--v-color-danger);
        border-color: var(--v-color-danger);
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-danger) var(--v-button-mix-hover-strong),
        black var(--v-button-mix-hover-strong-contrast)
      );
    }
  }

  &.v-accent {
    button {
      color: var(--v-color-text);
      background: var(--v-color-surface);
      border-color: var(--v-color-border-subtle);
    }

    @media (hover: hover) {
      button:hover {
        color: var(--v-color-text-on-accent, white);
        background: var(--v-color-accent);
        border-color: var(--v-color-accent);
      }
    }

    button:active {
      background: color-mix(
        in oklab,
        var(--v-color-accent) var(--v-button-mix-hover-strong),
        black var(--v-button-mix-hover-strong-contrast)
      );
    }
  }
}

:host(.v-no-shadow) button {
  box-shadow: none !important;

  &:hover {
    box-shadow: none !important;
  }

  &:active {
    box-shadow: none !important;
  }
}
